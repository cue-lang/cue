{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "6bdce9aa_04ac8ee6",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1017720
      },
      "writtenOn": "2023-06-21T16:17:03Z",
      "side": 1,
      "message": "Such a simple fix, but as always, I wonder how you got there :) I did investigate the stack trace and read the code a few weeks ago, but I couldn\u0027t easily find where the cycle was meant to be detected or stopped.",
      "revId": "403d273cb223daefc54a8f3d537b86a516eb3838",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9341af87_44a23708",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1013536
      },
      "writtenOn": "2023-06-22T07:47:01Z",
      "side": 1,
      "message": "It was a long road! One issue was that a Vertex could retain its arcs even when it was erroneous. This caused the dynamic evaluation in dep to descend recursively. However, keeping arcs is fine for incomplete errors, so I had to special case that. One of your reducers actually triggered the bug for incomplete errors as well. This meant the fix was not workable and it was back to the drawing board.\n\nMy conclusion was then that there must be some other mechanism to break cycles. When investigating where this could be, I noticed that there was already some cycle handling code and that it still was not triggered. That fixed it. It now looks that it is actually tools/flow that was traversing a graph cyclicly, not dep.\n\nSo note that I went from the evaluator has a representation bug, to dep isn\u0027t handling cycles correctly, to tools/flow isn\u0027t handling cycles correctly.\n\nAnyway, moral of the story is that I do not generally magically find these fixes. :)",
      "parentUuid": "6bdce9aa_04ac8ee6",
      "revId": "403d273cb223daefc54a8f3d537b86a516eb3838",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "42c51b5d_e8cc9ac8",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1017720
      },
      "writtenOn": "2023-06-22T07:54:19Z",
      "side": 1,
      "message": "Ah, gotcha, so at least it wasn\u0027t \"I just know it\" :) It would still be good to learn your debugging methods, because I often simply add debug prints and re-run a program. That doesn\u0027t seem to work very well with the evaluator.",
      "parentUuid": "9341af87_44a23708",
      "revId": "403d273cb223daefc54a8f3d537b86a516eb3838",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "60343d18_5208c25b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1013536
      },
      "writtenOn": "2023-06-22T09:59:44Z",
      "side": 1,
      "message": "The OpContext has a Logf method that indents based on the path that is being evaluated. That is quite useful. If there is some cycle, that only works well with a source-level debugger.\n\nVarious packages have a TestX method where it is easy to past in some code and have some basic infrastructure in place. The one I use the most is internal/core/adt/eval_test.go. But in this case I used the one in flow_test.go and script_test.go.\n\nFor cycles, it is very much a matter of looking at the trace, spotting the cycle, and reasoning through why it happens. Not to say that it is easy to figure out why it happens.",
      "parentUuid": "42c51b5d_e8cc9ac8",
      "revId": "403d273cb223daefc54a8f3d537b86a516eb3838",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8e6cc14b_39e56be5",
        "filename": "cmd/cue/cmd/testdata/script/cmd_cycle.txtar",
        "patchSetId": 1
      },
      "lineNbr": 36,
      "author": {
        "id": 1017720
      },
      "writtenOn": "2023-06-21T16:17:03Z",
      "side": 1,
      "message": "is this meant to be kept commented out? perhaps just delete it if not helpful.",
      "revId": "403d273cb223daefc54a8f3d537b86a516eb3838",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "33f454e8_56d83b33",
        "filename": "cmd/cue/cmd/testdata/script/cmd_cycle.txtar",
        "patchSetId": 1
      },
      "lineNbr": 36,
      "author": {
        "id": 1013536
      },
      "writtenOn": "2023-06-22T07:47:01Z",
      "side": 1,
      "message": "This came from the original bug report. I kept it as it may be useful to understand under which conditions the bug was triggered, if it ever were to regress.\n\nRemoved it in favor of a comment, as this block is still documented in the original issue.",
      "parentUuid": "8e6cc14b_39e56be5",
      "revId": "403d273cb223daefc54a8f3d537b86a516eb3838",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fc5be4d4_9e7ecb51",
        "filename": "tools/flow/testdata/template.txtar",
        "patchSetId": 1
      },
      "lineNbr": 88,
      "author": {
        "id": 1017720
      },
      "writtenOn": "2023-06-21T16:17:03Z",
      "side": 1,
      "message": "how come this file is changing?",
      "revId": "403d273cb223daefc54a8f3d537b86a516eb3838",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d16bfef1_b2943248",
        "filename": "tools/flow/testdata/template.txtar",
        "patchSetId": 1
      },
      "lineNbr": 88,
      "author": {
        "id": 1013536
      },
      "writtenOn": "2023-06-22T07:47:01Z",
      "side": 1,
      "message": "The change triggers a different order of evaluation, which causes fields to be ordered differently.\n\nClearly, we need to establish a more defined and stable field ordering, but that is a concern for elsewhere.",
      "parentUuid": "fc5be4d4_9e7ecb51",
      "revId": "403d273cb223daefc54a8f3d537b86a516eb3838",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "dede1ab6_a4a030bc",
        "filename": "tools/flow/testdata/template.txtar",
        "patchSetId": 1
      },
      "lineNbr": 88,
      "author": {
        "id": 1017720
      },
      "writtenOn": "2023-06-22T07:54:19Z",
      "side": 1,
      "message": "Acknowledged",
      "parentUuid": "d16bfef1_b2943248",
      "revId": "403d273cb223daefc54a8f3d537b86a516eb3838",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    }
  ]
}