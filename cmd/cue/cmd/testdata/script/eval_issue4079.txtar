exec cue eval -e '#c' x.cue
cmp stdout out/stdout-c

exec cue eval -e 'd' x.cue
cmp stdout out/stdout-d

exec cue eval x.cue
cmp stdout out/stdout

-- x.cue --
import "struct"

#c: matchN(1, [{
	a!: _
	c?: _
}, {
	b!: _
	c?: _
}]) & {
	c!: _
}

d: struct.MinFields(3) & {
	x!: 4
	...
}
issue3633: {
	// With nested matchNs as below, the schema will become an incomplete error
	// as a value of the root vertex. Make sure this edge case is properly
	// handled.
	data: {} & #s
	#s: matchN(1, [matchN(1, [{a!: _}])])
}
-- out/stdout-c --
matchN(1, [{
    a!: _
    c?: _
}, {
    b!: _
    c?: _
}]) & {
    c!: _
}
-- out/stdout-d --
import "struct"

struct.MinFields(3) & {
    x!: 4
    ...
}
-- out/stdout --
import "struct"

#c: matchN(1, [{
    a!: _
    c?: _
}, {
    b!: _
    c?: _
}]) & {
    c!: _
}
d: struct.MinFields(3) & {
    x!: 4
    ...
}
issue3633: {
    data: #s & {}
    #s: matchN(1, [matchN(1, [{
        a!: _
    }])])
}
