# Test that a get go works for kubernetes types,
# including those special cases that result in _ and string
# that are specifically mentioned in help get go.

exec cue get go --local .
cmp ./file2_go_gen.cue ./file2_go_gen.cue.golden

-- go.mod --
module mod.test

go 1.21
-- cue.mod/module.cue --
module: "mod.test"
-- file1.go --
package pkg1

// +k8s:openapi-gen=true
-- file2.go --
package pkg1

type Foo struct {
	Regular  string `json:"regular"`
	// +required
	Required string `json:"required"`
	Pointer *string `json:"pointer"`
	OmitEmptyPointer *string `json:"omitEmptyPointer,omitempty"`
	// +optional
    OptionalComment string `json:"optionalComment"`
	// +optional
    OptionalCommentPointer *string `json:"optionalCommentPointer"`
	// +nullable
    NullableCommentPointer *string `json:"nullableCommentPointer"`
	// +optional
	// +nullable
    OptionalNullableCommentPointer *string `json:"optionalNullableCommentPointer"`
}
-- file2_go_gen.cue.golden --
// Code generated by cue get go. DO NOT EDIT.

//cue:generate cue get go mod.test

package pkg1

#Foo: {
	regular: string @go(Regular)

	// +required
	required:          string        @go(Required)
	pointer?:          null | string @go(Pointer,*string)
	omitEmptyPointer?: null | string @go(OmitEmptyPointer,*string)

	// +optional
	optionalComment?: string @go(OptionalComment)

	// +optional
	optionalCommentPointer?: null | string @go(OptionalCommentPointer,*string)

	// +nullable
	nullableCommentPointer?: null | string @go(NullableCommentPointer,*string)

	// +optional
	// +nullable
	optionalNullableCommentPointer?: null | string @go(OptionalNullableCommentPointer,*string)
}
