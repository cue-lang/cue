# _test.cue files should be ignored apart from for
# dependency analysis purposes. Note there is
# currently no way to use test files other than
# naming them specifically on the command line.
exec cue export
cmp stdout want-eval

exec cue mod tidy
cmp cue.mod/module.cue want-tidy

-- want-eval --
{
    "x": {
        "self": "d1"
    }
}
-- want-tidy --

-- cue.mod/module.cue --
module: "test.example/main"
language: version: "v0.9.2"

deps: "test.example/d1": v: "v0.0.1"

-- main.cue --
package main

import "test.example/d1"

x: d1

-- main_test.cue --
package main

import "test.example/d2"

y: d3

-- _registry/test.example_d1_v0.0.1/cue.mod/module.cue --
module: "test.example/d1"
language: version: "v0.9.2"

-- _registry/test.example_d1_v0.0.1/x.cue --

package d1

self: "d1"

-- _registry/test.example_d1_v0.0.1/x_test.cue --

package d1

import "test.example/d3"

test: true
x: d3

-- _registry/test.example_d2_v0.0.1/cue.mod/module.cue --
module: "test.example/d2"
language: version: "v0.9.2"

-- _registry/test.example_d2_v0.0.1/x.cue --

package d2

self: "d2"

-- _registry/test.example_d3_v0.0.1/cue.mod/module.cue --
module: "test.example/d3"
language: version: "v0.9.2"

-- _registry/test.example_d3_v0.0.1/x.cue --

package d3

self: "d3"
