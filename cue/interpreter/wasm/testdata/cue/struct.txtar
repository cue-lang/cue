exec cue eval -E --out cue
cmp stdout out/wasm

-- a.cue --
@extern("wasm")
package p

import "math"

#vector2: {
	x: float64
	y: float64
}

magnitude2: _ @extern("struct.wasm", abi=c, sig="func(#vector2): float64")
magnitude3: _ @extern("struct.wasm", abi=c, sig="func(#vector3): float64")

_v0: {x: 1, y: 1}
_v1: {x: math.Sqrt2, y: math.Sqrt2}
_v2: {x: 123.456, y: 789.012}

m0: magnitude2(_v0)
m1: magnitude2(_v1)
m2: magnitude2(_v2)

normalize2: _ @extern("struct.wasm", abi=c, sig="func(#vector2): #vector2")
n2: normalize2(_v1)
n2m: magnitude2(n2)

#vector3: {
	x: float64
	y: float64
	z: float64
}

_v3: {x: 1, y: 1, z: 1}
_v4: {x: 0, y: 2, z: 2}
_v5: {x: 3.84900179459750509672765853667971637098401167513417917345734884322651781535288897129144, y: 3.84900179459750509672765853667971637098401167513417917345734884322651781535288897129144, z: 3.84900179459750509672765853667971637098401167513417917345734884322651781535288897129144}

m3: magnitude3(_v3)
m4: magnitude3(_v4)
m5: magnitude3(_v5)

double3: _ @extern("struct.wasm", abi=c, sig="func(#vector3): #vector3")
d4: double3(_v4)
-- struct.wasm --
-- out/wasm --
Errors:
m0: cannot call non-function magnitude2 (type _):
    ./a.cue:18:5
m1: cannot call non-function magnitude2 (type _):
    ./a.cue:19:5
m2: cannot call non-function magnitude2 (type _):
    ./a.cue:20:5
n2: cannot call non-function normalize2 (type _):
    ./a.cue:23:5
n2m: cannot call non-function magnitude2 (type _):
    ./a.cue:24:6
m3: cannot call non-function magnitude3 (type _):
    ./a.cue:36:5
m4: cannot call non-function magnitude3 (type _):
    ./a.cue:37:5
m5: cannot call non-function magnitude3 (type _):
    ./a.cue:38:5
d4: cannot call non-function double3 (type _):
    ./a.cue:41:5

Result:
#vector2: {
    x: float64
    y: float64
}
magnitude2: magnitude2()
magnitude3: magnitude3()
m0:         _|_ // m0: cannot call non-function magnitude2 (type _)
m1:         _|_ // m1: cannot call non-function magnitude2 (type _)
m2:         _|_ // m2: cannot call non-function magnitude2 (type _)
normalize2: normalize2
n2:         _|_ // n2: cannot call non-function normalize2 (type _)
n2m:        _|_ // n2m: cannot call non-function magnitude2 (type _)
#vector3: {
    x: float64
    y: float64
    z: float64
}
m3:      _|_ // m3: cannot call non-function magnitude3 (type _)
m4:      _|_ // m4: cannot call non-function magnitude3 (type _)
m5:      _|_ // m5: cannot call non-function magnitude3 (type _)
double3: double3
d4:      _|_ // d4: cannot call non-function double3 (type _)
