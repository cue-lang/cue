exec /bin/cp -r $TESTDATA/basic .
exec /bin/cp -r $TESTDATA/morewasm .
exec /bin/cp -r $TESTDATA/noload .
exec /bin/cp -r $TESTDATA/unusedwasm .

exec cue def ./basic ./morewasm ./noload ./unusedwasm
cmp stdout eval.out

-- eval.out --
package p

add: add   @extern("foo.wasm", abi=c, sig="func(int64, int64): int64")
mul: mul   @extern("foo.wasm", abi=c, sig="func(float64, float64): float64")
not: not() @extern("foo.wasm", abi=c, sig="func(bool): bool")
x0:  add(1, 2)
x1:  add(-1, 2)
x2:  add(100, 1)
y0:  mul(3.0, 5.0)
y1:  mul(-2.5, 3.37)
y2:  mul(1.234, 5.678)
z:   not(true)
// ---
package p

add:     add        @extern("foo.wasm", abi=c, sig="func(int64, int64): int64")
isPrime: is_prime() @extern("bar.wasm", abi=c, name=is_prime, sig="func(uint64): bool")
fact:    fact       @extern("bar.wasm", abi=c, sig="func(uint64): uint64")
a0:      neg32(42)
b1:      isPrime(127)
b2:      isPrime(128)
c1:      fact(7)
neg32:   neg32 @extern("bar.wasm", abi=c, sig="func(int32): int32")
mul:     mul   @extern("foo.wasm", abi=c, sig="func(float64, float64): float64")
not:     not() @extern("foo.wasm", abi=c, sig="func(bool): bool")
x0:      add(1, 2)
x1:      add(-1, 2)
x2:      add(100, 1)
y0:      mul(3.0, 5.0)
y1:      mul(-2.5, 3.37)
y2:      mul(1.234, 5.678)
c2:      fact(9)
z:       not(true)
// ---
package p

x: 42
// ---
package p

add: add @extern("foo.wasm", abi=c, sig="func(int64, int64): int64")
x0:  add(1, 2)
x1:  add(-1, 2)
x2:  add(100, 1)
