#IgnoreConcrete: true
#InferTasks: true
-- in.cue --
package x

root: {
	prepare: {
		$id: "prepare"
		stdout: string
	}
	env2: {
		// Note: the string interpolation here is the only difference
		// from issue2517.txtar. It makes the value incomplete
		// rather than just non-concrete.
		input: "\(prepare.stdout)"
	}
	run: {
		$id: "run"
		env: env2
	}
}
-- out/run/errors --
-- out/run/t0 --
graph TD
  t0("root.prepare [Ready]")
  t1("root.run [Waiting]")
  t1-->t0

-- out/run/t1 --
graph TD
  t0("root.prepare [Terminated]")
  t1("root.run [Ready]")
  t1-->t0

-- out/run/t1/value --
{
	$id:    "prepare"
	stdout: "foo"
}
-- out/run/t2 --
graph TD
  t0("root.prepare [Terminated]")
  t1("root.run [Terminated]")
  t1-->t0

-- out/run/t2/value --
{
	$id: "run"
	env: {
		input: "foo"
	}
	stdout: "foo"
}
